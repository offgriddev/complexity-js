# CyclomaticJS - A Complexity Measure for JavaScript

Cyclomatic Complexity was developed by a Computer Scientist at IBM named Thomas McCabe in an article titled [A Complexity Measure](https://ieeexplore.ieee.org/document/1702388). A metric we often use to identify "code quality" concerns, cyclomatic complexity is a useful analytical tool for many reasons. And now it's available for both CommonJS and ESModules JavaScript repositories! 

First, let's cover the technical How-To for the contained NPM package and it's GitHub Action. Second, we'll dive deep into theory and explain why you would even want to use this anyway. 

## Using

You can levarage CyclomaticJS as both a standalone import for your JavaScript project or as a GitHub Action in your CI workflows. 

## CyclomaticJS as an Import

CyclomaticJS provides a library for importing into JS:

```javascript
import { calculateComplexity } from 'cyclomatic-js'

const complexity = calculateComplexity('somefile.js')
console.log(complexity)
```

This will produce a file called `complexity-report.json` in the main directory of your repository. The file will loo like this:

```json
[
  {
    "file": "./src/some-file.js",
    "report": {
      "function1": 2,
      "function2": 1,
      "function3": 3
    }
  }
]
```

The report object is simple, it contains the filename and a `report` with the function name and the cyclomatic complexity for that function.

## CyclomaticJS as a GitHub Action

CyclomaticJS also provides a GitHub Action to generate a report for pushing to any BI tool or storage for aggregation and analysis:

```yml
    - name: Generate Code Metrics for Commit
      id: metrics
      uses: offgriddev/cyclomatic-js@main
      with:
        github_token: ${{ github.token }}
        event: ${{ toJson(github.event) }}
```

This action has one export: `export_filename`. This stores the filename for the report generated by the complexity reporter in the CyclomaticJS package.

## Why Use CyclomaticJS?

To answer why you would want to use CyclomaticJS, you need to know a little about the code metric it uses. You may be new to software engineering, or you might be a senior or director and have not thoughtfully understood this concept. So let us briefly cover its nature.

### What is Cyclomatic Complexity

Cyclomatic Complexity, the code metric this repository analyses, measures the number of linear paths through a given function. Your function may be simple:

```javascript
function getNumberPolarity(a) {
  if (a > 0) {
    return "is positive"
  } else if (a < 0) {
    return "is negative"
  } else {
    return "is neither positive nor negative"
  }
}
```

But as you can see, given a specific range of the variable `a`, the output may be different. There are three possible outputs.

1. When `a > 0`, the output is `is positive`.
2. When `a < 0`, the output is `is negative`.
3. When `a == 0`, the output is `is neither positive nor negative`.

Since there are 3 possible paths through this function, the Cyclomatic Complexity is 3. This is acquired by creating an Abstract Syntax Tree and measuring the _logical structures_ of a function. An `IfStatement`, for example, increases the Cyclomatic Complexity of the function because it creates a _logical branch_ in it. The lowest possible number of logical branches in a given function is 1 as an empty `BlockStatement`, or `function empty() { }` has one logical branch. 

### Logical Structures that Increase Complexity

These logical structures are Universal. Any Turing Complete language can be measured by its logical structures. The following statements and expressions unconditionally increase the complexity of a function:

`IfStatement`
`TryStatement`
`CatchClause`
`DoWhileStatement`
`ForInStatement`
`ForOfStatement`
`WhileStatement`
`ConditionalExpression`

The following conditionally increase the complexity of a function:

`SwitchCase` as in the `case` statement of a `SwitchStatement` increases the complexity when the `case` has statements.
`LogicalExpression` increases the complexity when it is a `||`, `&&`, or `??`.


### Why Use Cyclomatic Complexity

Now for the question you may have asked yourself at some point if you've made it this far and have been looking for a JavaScript library to do this analysis for you. There are two main personas this library and action are targetting: Developers and anyone concerned with _estimations_. That last persona is vague. I promise, I will get there. 

From a developer perspective, you may be concerned with Code Quality and Maintainability. You may have linting rules setup to limit the "size" if your functions, e.g. [eslint-complexity](https://eslint.org/docs/latest/rules/complexity). Some developers have a genuine interest in this as an engineering concern, and rightfully so. This may be around modularization and the role of writing more simple and elegant functions. 

If you don't believe Cyclomatic Complexity or nerd out on analysing the logical complexity of your code, then you may be concerned about Estimations in some sense. You might be a Project Manager, a Lead Engineer, or perhaps you work in Professional Services and are putting a bid on a job and want to be competitive _and_ realistic.

That's right, you might want to give a _realistic estimation for a given software development effort_. You might, for example, be the CTO and need to report to ELT a high-level estimate for getting funding for a project. The second category is broad, but you want to provide as realistic of an estimation as you can.

## Estimation 



# Supported Source Code

CyclomaticJS supports both CommonJS and ESModules. Please raise an issue if there are problems with either module loading systems.